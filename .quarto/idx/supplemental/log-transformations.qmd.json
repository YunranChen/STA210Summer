{"title":"Log Transformations in Linear Regression","markdown":{"yaml":{"title":"Log Transformations in Linear Regression","execute":{"echo":false}},"headingText":"| include: false","containsRefs":false,"markdown":"\n\n::: callout-note\nThe following supplemental notes were created by [Dr. Maria Tackett](https://www.mariatackett.net/) for STA 210.\nThey are provided for students who want to dive deeper into the mathematics behind regression and reflect some of the material covered in STA 211: Mathematics of Regression.\nAdditional supplemental notes will be added throughout the semester.\n:::\n\n```{r}\n\nlibrary(tidyverse)\nlibrary(knitr)\n```\n\nThis document provides details about the model interpretation when the predictor and/or response variables are log-transformed.\nFor simplicity, we will discuss transformations for the simple linear regression model as shown in @eq-orig.\n\n$$\n\\label{orig}\ny = \\beta_0 + \\beta_1 x\n$$ {#eq-orig}\n\nAll results and interpretations can be easily extended to transformations in multiple regression models.\n\nNote: *log* refers to the natural logarithm.\n\n## Log-transformation on the response variable\n\nSuppose we fit a linear regression model with $\\log(y)$, the log-transformed $y$, as the response variable.\nUnder this model, we assume a linear relationship exists between $x$ and $\\log(y)$, such that $\\log(y) \\sim N(\\beta_0 + \\beta_1 x, \\sigma^2)$ for some $\\beta_0$, $\\beta_1$ and $\\sigma^2$.\nIn other words, we can model the relationship between $x$ and $\\log(y)$ using the model in @eq-log-y.\n\n$$\n\\log(y) = \\beta_0 + \\beta_1 x\n$$ {#eq-log-y}\n\nIf we interpret the model in terms of $\\log(y)$, then we can use the usual interpretations for slope and intercept.\nWhen reporting results, however, it is best to give all interpretations in terms of the original response variable $y$, since interpretations using log-transformed variables are often more difficult to truly understand.\n\nIn order to get back on the original scale, we need to use the exponential function (also known as the anti-log), $\\exp\\{x\\} = e^x$.\nTherefore, we use the model in @eq-log-y for interpretations and predictions, we will use @eq-exp-y to state our conclusions in terms of $y$.\n\n$$\n\\begin{aligned}\n&\\exp\\{\\log(y)\\} = \\exp\\{\\beta_0 + \\beta_1 x\\} \\\\[10pt]\n\\Rightarrow &y = \\exp\\{\\beta_0 + \\beta_1 x\\} \\\\[10pt]\n\\Rightarrow &y = \\exp\\{\\beta_0\\}\\exp\\{\\beta_1 x\\}\n\\end{aligned}\n$$ {#eq-exp-y}\n\nIn order to interpret the slope and intercept, we need to first understand the relationship between the mean, median and log transformations.\n\n### Mean, Median, and Log Transformations\n\nSuppose we have a dataset `y` that contains the following observations:\n\n```{r}\ny <- c(3,5,6,7,8)\ny\n```\n\nIf we log-transform the values of `y` then calculate the mean and median, we have\n\n```{r}\nlog_y <- tibble(log_y = log(y))\nsummary <- log_y %>% \n  summarise(mean_log_y = mean(log_y), median_log_y = median(log_y))\nkable(summary,digits=5)\n```\n\nIf we calculate the mean and median of `y`, then log-transform the mean and median, we have\n\n```{r}\ncenters <- tibble(y) %>% \n  summarise(mean_y = mean(y), median_y = median(y))\nsummary2 <- centers %>% \n  summarise(log_mean = log(mean_y), log_median = log(median_y))\nkable(summary2, digits = 5)\n```\n\nThis is a simple illustration to show\n\n1.  $\\text{Mean}[{\\log(y)}] \\neq \\log[\\text{Mean}(y)]$ - the mean and log are not commutable\n\n2.  $\\text{Median}[\\log(y)] = \\log[\\text{Median}(y)]$ - the median and log are commutable\n\n### Interpretaton of model coefficients\n\nUsing @eq-log-y, the mean $\\log(y)$ for any given value of $x$ is $\\beta_0 + \\beta_1 x$; however, this does **not** indicate that the mean of $y = \\exp\\{\\beta_0 + \\beta_1 x\\}$ (see previous section).\nFrom the assumptions of linear regression, we assume that for any given value of $x$, the distribution of $\\log(y)$ is Normal, and therefore symmetric.\nThus the median of $\\log(y)$ is equal to the mean of $\\log(y)$, i.e $\\text{Median}(\\log(y)) = \\beta_0 + \\beta_1 x$.\n\nSince the log and the median are commutable, $\\text{Median}(\\log(y)) = \\beta_0 + \\beta_1 x \\Rightarrow \\text{Median}(y) = \\exp\\{\\beta_0 + \\beta_1 x\\}$.\nThus, when we log-transform the response variable, the interpretation of the intercept and slope are in terms of the effect on the **median** of $y$.\n\n**Intercept**: The intercept is expected median of $y$ when the predictor variable equals 0.\nTherefore, when $x=0$,\n\n$$\n\\begin{aligned}\n&\\log(y) = \\beta_0 + \\beta_1 \\times 0 = \\beta_0 \\\\[10pt]\n\\Rightarrow &y = \\exp\\{\\beta_0\\}\n\\end{aligned}\n$$\n\nInterpretation: When $x=0$, the median of $y$ is expected to be $\\exp\\{\\beta_0\\}$.\n\n**Slope**: The slope is the expected change in the median of $y$ when $x$ increases by 1 unit.\nThe change in the median of $y$ is\n\n$$\n\\exp\\{[\\beta_0 + \\beta_1 (x+1)] - [\\beta_0 + \\beta_1 x]\\} = \\frac{\\exp\\{\\beta_0 + \\beta_1 (x+1)\\}}{\\exp\\{\\beta_0 + \\beta_1 x\\}} = \\frac{\\exp\\{\\beta_0\\}\\exp\\{\\beta_1 x\\}\\exp\\{\\beta_1\\}}{\\exp\\{\\beta_0\\}\\exp\\{\\beta_1 x\\}} = \\exp\\{\\beta_1\\}\n$$\n\nThus, the median of $y$ for $x+1$ is $\\exp\\{\\beta_1\\}$ times the median of $y$ for $x$.\n\nInterpretation: When $x$ increases by one unit, the median of $y$ is expected to multiply by a factor of $\\exp\\{\\beta_1\\}$.\n\n## Log-transformation on the predictor variable\n\nSuppose we fit a linear regression model with $\\log(x)$, the log-transformed $x$, as the predictor variable.\nUnder this model, we assume a linear relationship exists between $\\log(x)$ and $y$, such that $y \\sim N(\\beta_0 + \\beta_1 \\log(x), \\sigma^2)$ for some $\\beta_0$, $\\beta_1$ and $\\sigma^2$.\nIn other words, we can model the relationship between $\\log(x)$ and $y$ using the model in #eq-log-x.\n\n$$\ny = \\beta_0 + \\beta_1 \\log(x)\n$$ {#eq-log-x}\n\n**Intercept**: The intercept is the mean of $y$ when $\\log(x) = 0$, i.e. $x = 1$.\n\nInterpretation: When $x = 1$ $(\\log(x) = 0)$, the mean of $y$ is expected to be $\\beta_0$.\n\n**Slope**: The slope is interpreted in terms of the change in the mean of $y$ when $x$ is multiplied by a factor of $C$, since $\\log(Cx) = \\log(x) + \\log(C)$.\nThus, when $x$ is multiplied by a factor of $C$, the change in the mean of $y$ is\n\n$$\n\\begin{aligned}\n[\\beta_0 + \\beta_1 \\log(Cx)] - [\\beta_0 + \\beta_1 \\log(x)] &= \\beta_1 [\\log(Cx) - \\log(x)] \\\\[10pt] \n& = \\beta_1[\\log(C) + \\log(x) - \\log(x)] \\\\[10pt] \n& = \\beta_1 \\log(C)\n\\end{aligned}\n$$\n\nThus the mean of $y$ changes by $\\beta_1 \\log(C)$ units.\n\nInterpretation: When $x$ is multiplied by a factor of $C$, the mean of $y$ is expected to change by $\\beta_1 \\log(C)$ units.\nFor example, if $x$ is doubled, then the mean of $y$ is expected to change by $\\beta_1 \\log(2)$ units.\n\n## Log-transformation on the the response and predictor variable\n\nSuppose we fit a linear regression model with $\\log(x)$, the log-transformed $x$, as the predictor variable and $\\log(y)$, the log-transformed $y$, as the response variable.\nUnder this model, we assume a linear relationship exists between $\\log(x)$ and $\\log(y)$, such that $\\log(y) \\sim N(\\beta_0 + \\beta_1 \\log(x), \\sigma^2)$ for some $\\beta_0$, $\\beta_1$ and $\\sigma^2$.\nIn other words, we can model the relationship between $\\log(x)$ and $\\log(y)$ using the model in @eq-log-x-y.\n\n$$\n\\log(y) = \\beta_0 + \\beta_1 \\log(x)\n$$ {#eq-log-x-y}\n\nBecause the response variable is log-transformed, the interpretations on the original scale will be in terms of the median of $y$ (see the section on the log-transformed response variable for more detail).\n\n**Intercept**: The intercept is the mean of $y$ when $\\log(x) = 0$, i.e. $x = 1$.\nTherefore, when $\\log(x) = 0$,\n\n$$\n\\begin{aligned}\n&\\log(y) = \\beta_0 + \\beta_1 \\times 0 = \\beta_0 \\\\[10pt]\n\\Rightarrow &y = \\exp\\{\\beta_0\\}\n\\end{aligned}\n$$\n\nInterpretation: When $x = 1$ $(\\log(x) = 0)$, the median of $y$ is expected to be $\\exp\\{\\beta_0\\}$.\n\n**Slope**: The slope is interpreted in terms of the change in the median $y$ when $x$ is multiplied by a factor of $C$, since $\\log(Cx) = \\log(x) + \\log(C)$.\nThus, when $x$ is multiplied by a factor of $C$, the change in the median of $y$ is\n\n$$\n\\begin{aligned}\n\\exp\\{[\\beta_0 + \\beta_1 \\log(Cx)] - [\\beta_0 + \\beta_1 \\log(x)]\\} &= \n\\exp\\{\\beta_1 [\\log(Cx) - \\log(x)]\\} \\\\[10pt] \n& = \\exp\\{\\beta_1[\\log(C) + \\log(x) - \\log(x)]\\} \\\\[10pt] \n& = \\exp\\{\\beta_1 \\log(C)\\} = C^{\\beta_1}\n\\end{aligned}\n$$\n\nThus, the median of $y$ for $Cx$ is $C^{\\beta_1}$ times the median of $y$ for $x$.\n\nInterpretation: When $x$ is multiplied by a factor of $C$, the median of $y$ is expected to multiple by a factor of $C^{\\beta_1}$.\nFor example, if $x$ is doubled, then the median of $y$ is expected to multiply by $2^{\\beta_1}$.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"error":false,"eval":true,"cache":null,"freeze":"auto","echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"log-transformations.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"0.9.345","editor":"visual","theme":{"light":["cosmo","../theme.scss"],"dark":["cosmo","../theme-dark.scss"]},"mainfont":"Atkinson Hyperlegible","code-copy":true,"title":"Log Transformations in Linear Regression"},"extensions":{"book":{"multiFile":true}}}}}